<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>เช็กลิสต์งาน</title>
  <style>
    body { font-family: sans-serif; background:#f8fafc; color:#111827; margin:0; padding:1rem; }
    h1 { font-size:1.5rem; margin-bottom:0.25rem; }
    .progress { background:#e5e7eb; border-radius:8px; overflow:hidden; height:12px; }
    .progress-bar { background:#22c55e; height:100%; }
    .task { background:#fff; border-radius:12px; box-shadow:0 1px 2px rgba(0,0,0,0.1); padding:1rem; margin-bottom:1rem; }
    .task h3 { margin:0; font-size:1rem; }
    .task small { color:#6b7280; }
    textarea { width:100%; min-height:60px; margin-top:0.5rem; }
    .topbar { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem; }
    button { margin-left:0.5rem; }
  </style>
</head>
<body>
  <div class="topbar">
    <div>
      <h1>เช็กลิสต์งาน</h1>
      <p style="color:#6b7280">ติ๊กสิ่งที่ทำแล้ว บันทึกโน้ตได้</p>
    </div>
    <div>
      <button onclick="addTask()">+ เพิ่มงาน</button>
      <button onclick="resetAll()">รีเซ็ตทั้งหมด</button>
    </div>
  </div>

  <div>
    <div style="margin-bottom:0.5rem; display:flex; justify-content:space-between;">
      <span><b>ความคืบหน้า</b></span>
      <span id="progressText">0%</span>
    </div>
    <div class="progress"><div id="progressBar" class="progress-bar" style="width:0%"></div></div>
  </div>

  <div id="taskList"></div>

<script>
const STORAGE_KEY = "checklist-v1";
let tasks = JSON.parse(localStorage.getItem(STORAGE_KEY) || "null") || [
  {id:"t1", title:"ตัวอย่างงาน", note:"", done:false}
];

function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks)); }

function toggleTask(id){
  tasks = tasks.map(t => t.id===id? {...t, done:!t.done}:t);
  render();
}

function updateNote(id, note){
  tasks = tasks.map(t => t.id===id? {...t, note}:t);
  save();
}

function addTask(){
  const id = "t"+Math.random().toString(36).substr(2,6);
  tasks.push({id, title:"งานใหม่", note:"", done:false});
  render();
}

function resetAll(){
  if(confirm("ล้างสถานะทั้งหมด?")){
    tasks = [];
    render();
  }
}

function render(){
  const list = document.getElementById("taskList");
  list.innerHTML = "";
  tasks.forEach(t => {
    const div = document.createElement("div");
    div.className = "task";
    div.innerHTML = `
      <label>
        <input type="checkbox" ${t.done?"checked":""} onchange="toggleTask('${t.id}')" />
        <h3 style="display:inline">${t.title}</h3>
      </label>
      <div><small>โน้ต:</small></div>
      <textarea onchange="updateNote('${t.id}', this.value)">${t.note||""}</textarea>
    `;
    list.appendChild(div);
  });
  const done = tasks.filter(t=>t.done).length;
  const pct = tasks.length? Math.round(done/tasks.length*100):0;
  document.getElementById("progressBar").style.width = pct+"%";
  document.getElementById("progressText").innerText = pct+"%";
  save();
}

render();
</script>
</body>
</html>
